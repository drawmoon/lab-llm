
要将包上传到 PyPI，需要使用名为 Twine 与 Wheel 的工具：

```bash
pip install --upgrade twine wheel
```

#### 构建前的准备

执行以下命令对包进行检查：

```bash
python setup.py check
```

#### 构建包

PyPI 上的包需要被包装成发行包，发行包最常见的格式是源代码档案（`.tar.gz`）与 Python wheels（`.whl`）。

执行以下命令构建发行包：

```bash
python setup.py sdist bdist_wheel
```

构建完成会在项目根目录创建 `dist` 目录，里面会包含 `.tar.gz` 和 `.whl` 文件。

#### 测试包

本地测试包是否能成功安装：

```bash
pip install dist\pyprojname-1.0.0-py3-none-any.whl
```

检查包是否能在 PyPI 中正常呈现：

```bash
twine check dist/*
```

输出 `PASSED` 即表示通过。

### 上传包

先上传包到 [TestPyPI](https://test.pypi.org/) 确保一切都按照预期工作：

```bash
twine upload --repository-url https://test.pypi.org/legacy/ dist/*
```

确保一切正确后，执行以下命令上传包到 [PyPI](https://pypi.org/)：

```bash
twine upload dist/*
```

#### 使用 ApiToken

如果你的账号开启了两步验证，使用账号密码发布时，可能会提示 `403 Forbidden` 错误，这时可以尝试使用 ApiToken 进行发布

在用户目录下新建 `.pypirc` 文件，内容如下：

```conf
[distutils]
  index-servers =
    pyprojname_release
    pyprojname_test

[pyprojname]
  repository = https://upload.pypi.org/legacy/
  username = __token__
  password = <your token>

[pyprojname_test]
  repository = https://test.pypi.org/legacy/
  username = __token__
  password = <your token>
```

然后执行以下命令上传包到 [PyPI](https://pypi.org/)：`

```bash
twine upload --repository pyprojname_release dist/*
```
